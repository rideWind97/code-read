# React Fiber 简介

Fiber 是 React 16 引入的新架构，用于重写协调（Reconciliation）算法。它让 React 能够更好地控制渲染过程，实现任务分片、优先级调度、可中断渲染等能力，从而提升大型应用的性能和响应性。

## 需要掌握的知识点

### 1. 为什么要有 Fiber
- 解决 React 15 及以前“递归、同步、不可中断”渲染的性能瓶颈
- 支持异步渲染、优先级调度、动画流畅、响应用户输入

### 2. Fiber 的本质
- Fiber 是一种数据结构（链表），每个 Fiber 节点对应一个 React 元素
- 每个 Fiber 节点保存了当前组件的类型、属性、状态、子节点等信息

### 3. 工作原理
- **分阶段**：分为“调和（Reconciliation）”和“提交（Commit）”两阶段
  - 调和阶段：可以被中断、分片执行，找出需要更新的部分
  - 提交阶段：一次性、同步执行 DOM 更新
- **可中断**：利用 requestIdleCallback、MessageChannel 等机制，空闲时分批处理任务

### 4. 优先级调度
- 不同任务有不同优先级（如用户输入 > 动画 > 数据渲染）
- 高优先级任务可以打断低优先级任务，保证界面流畅

### 5. Fiber 树
- Fiber 树和虚拟 DOM 树结构类似，但 Fiber 节点间是链表关系，便于遍历和调度

### 6. 相关 API
- React 18 的并发特性（Concurrent Mode）、startTransition、Suspense、useDeferredValue 等，都是基于 Fiber 实现

## 总结

Fiber 让 React 渲染变得更灵活、更高效，支持异步、可中断、优先级调度等现代前端需求。掌握 Fiber，有助于深入理解 React 的底层原理和性能优化方向。
